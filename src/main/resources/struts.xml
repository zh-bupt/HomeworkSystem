<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
        "http://struts.apache.org/dtds/struts-2.5.dtd">

<struts>
    <constant name="struts.devMode" value="true"/>
    <constant name="struts.multipart.maxSize" value="1000000000"/>

    <package name="login" namespace="/" extends="struts-default">
        <action name="loginPageAction">
            <result name="">/pages/login.jsp</result>
        </action>
        <action name="loginAction"
                class="com.bupt.se.homework.action.LoginAction" method="login">

            <result name="admin" type="chain">listTeacherAction</result>
            <result name="teacher" type="chain">listCourseAction</result>
            <result name="student">/pages/student.jsp</result>
            <result name="login" type="chain">loginPageAction</result>
            <result name="changePW" >/pages/changePW.jsp</result>

        </action>
    </package>

    <package name="admin" namespace="/" extends="struts-default">
        <action name="addStudentAction"
                class="com.bupt.se.homework.action.AdminAction" method="addStudent">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="addStudentByFileAction"
                class="com.bupt.se.homework.action.AdminAction" method="addStudentByFile">
            <!-- 指定（限制）上传文件的类型，定义局部拦截器，修改默认拦截器的属性
                 "fileUpload.maximumSize" ：限制上传最大的文件大小。
                 "fileUpload.allowedTypes"：允许上传文件的类型。
                 "fileUpload.allowedExtensions"：允许上传文件的可扩展文件类型。 -->
            <interceptor-ref name="defaultStack">
                <param name="fileUpload.maximumSize">500000000</param>
                <!--<param name="fileUpload.allowedTypes">text/plain,application/vnd.ms-excel</param>-->
                <param name="fileUpload.allowedExtensions">.txt,.xlsx,.xls,.csv</param>
            </interceptor-ref>
            <result name="success">/pages/admin.jsp</result>
            <!-- 出现错误自动会返回input结果，进入结果视图 -->
            <result name="error" >/pages/error.jsp</result>
        </action>
        <action name="searchStudentAction"
                class="com.bupt.se.homework.action.AdminAction" method="listStudent">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="deleteStudentAction"
                class="com.bupt.se.homework.action.AdminAction" method="deleteStudent">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="updateStudentAction"
                class="com.bupt.se.homework.action.AdminAction" method="updateStudent">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="addTeacherAction"
                class="com.bupt.se.homework.action.AdminAction" method="addTeacher">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="addTeacherByFileAction"
                class="com.bupt.se.homework.action.AdminAction" method="addTeacherByFile">
            <!-- 指定（限制）上传文件的类型，定义局部拦截器，修改默认拦截器的属性
                 "fileUpload.maximumSize" ：限制上传最大的文件大小。
                 "fileUpload.allowedTypes"：允许上传文件的类型。
                 "fileUpload.allowedExtensions"：允许上传文件的可扩展文件类型。 -->
            <interceptor-ref name="defaultStack">
                <param name="fileUpload.maximumSize">500000000</param>
                <!--<param name="fileUpload.allowedTypes">text/plain,application/vnd.ms-excel</param>-->
                <param name="fileUpload.allowedExtensions">.txt,.xlsx,.xls,.csv</param>
            </interceptor-ref>
            <result name="success">/pages/admin.jsp</result>
            <!-- 出现错误自动会返回input结果，进入结果视图 -->
            <result name="error" >/pages/error.jsp</result>
        </action>
        <action name="listTeacherAction"
                class="com.bupt.se.homework.action.AdminAction" method="listTeacher">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="deleteTeacherAction"
                class="com.bupt.se.homework.action.AdminAction" method="deleteTeacher">
            <result name="success">/pages/admin.jsp</result>
        </action>
        <action name="updateTeacherAction"
                class="com.bupt.se.homework.action.AdminAction" method="updateTeacher">
            <result name="success">/pages/admin.jsp</result>
        </action>
    </package>

    <package name="teacher" namespace="/teacher" extends="struts-default">
        <action name="listCourseAction"
                class="com.bupt.se.homework.action.TeacherAction" method="listCourse">
            <result name="success">/pages/teacher.jsp</result>
        </action>
        <action name="addCourseAction"
                class="com.bupt.se.homework.action.TeacherAction" method="addCourse">
            <result name="success" type="chain">listCourseAction</result>
        </action>
        <action name="setCurrentCourseAction"
                class="com.bupt.se.homework.action.TeacherAction" method="setSessionCourse">
            <result name="success" type="chain">showCourseAction</result>
        </action>
        <action name="showCourseAction"
                class="com.bupt.se.homework.action.TeacherAction" method="listStudentAndHomework">
            <result name="success">/pages/teacher_course.jsp</result>
        </action>

    </package>
    <package name="course" namespace="/teacher" extends="struts-default">
        <action name="addStudentForCourseByFileAction"
                class="com.bupt.se.homework.action.TeacherAction" method="addStudentForCourseByFile">
            <!-- 指定（限制）上传文件的类型，定义局部拦截器，修改默认拦截器的属性
                 "fileUpload.maximumSize" ：限制上传最大的文件大小。
                 "fileUpload.allowedTypes"：允许上传文件的类型。
                 "fileUpload.allowedExtensions"：允许上传文件的可扩展文件类型。 -->
            <interceptor-ref name="defaultStack">
                <param name="fileUpload.maximumSize">500000000</param>
                <!--<param name="fileUpload.allowedTypes">text/plain,application/vnd.ms-excel</param>-->
                <param name="fileUpload.allowedExtensions">.txt,.xlsx,.xls,.csv</param>
            </interceptor-ref>

            <result name="success">/pages/teacher.jsp</result>
            <!-- 出现错误自动会返回input结果，进入结果视图 -->
            <result name="error" >/pages/error.jsp</result>
        </action>
        <action name="addStudentForCourseByTypeAction"
                class="com.bupt.se.homework.action.TeacherAction" method="addStudentForCourseByType">
            <result name="success" type="chain">showCourseAction</result>
        </action>
        <action name="addHomeworkAction"
                class="com.bupt.se.homework.action.TeacherAction" method="addHomework">
            <result name="success" type="chain">showCourseAction</result>
        </action>
    </package>
    <package name="student" namespace="/student" extends="struts-default">
        <action name="listCourseAction"
                class="com.bupt.se.homework.action.StudentAction" method="listCourse">
            <result name="success">/pages/student_course.jsp</result>
        </action>
        <action name="submitHomeworkAction"
                class="com.bupt.se.homework.action.StudentAction" method="submitHomework">
            <result name="success" type="chain">listCourseAction</result>
        </action>
    </package>

    <package name="Struts2" extends="struts-default" namespace="/">

        <action name="uploads" class="com.bupt.se.homework.action.UploadFileAction">

            <!-- 指定（限制）上传文件的类型，定义局部拦截器，修改默认拦截器的属性
                "fileUpload.maximumSize" ：限制上传最大的文件大小。
                "fileUpload.allowedTypes"：允许上传文件的类型。
                "fileUpload.allowedExtensions"：允许上传文件的可扩展文件类型。 -->
            <interceptor-ref name="defaultStack">
                <param name="fileUpload.maximumSize">500000000</param>
                <!--<param name="fileUpload.allowedTypes">text/plain,application/vnd.ms-excel,application/octet-stream</param>-->
                <param name="fileUpload.allowedExtensions">.txt,.xlsx,.csv,.xls,.tmp</param>
            </interceptor-ref>

            <result name="success">/pages/admin.jsp</result>
            <!-- 出现错误自动会返回input结果，进入结果视图 -->
            <result name="input" >/pages/error.jsp</result>
        </action>
    </package>
</struts>